{{ define "title" }}帳號管理{{ end }}
{{ define "content-with-session" }}
<script src="/js/delete.js"></script>
<script src="/js/update.js"></script>
<h1>帳號管理</h1>
{{ $acct := .Account }}
{{ if eq $acct.Role 1 }}
<a href="/register">新增使用者</a>
<a href="/import">匯入帳號資料 (.csv 檔)</a>
{{ end }}
<table>
    <tr>
        <th>帳號</th>
        <th>班級</th>
        <th>座號</th>
        <th>姓名</th>
        <th>權限</th>
        <th></th>
        {{ if eq $acct.Role 1 }}
        <th></th>
        <th></th>
        {{ end }}
    </tr>
    <tbody>
        {{ range .Data }}
        <tr>
            <td>{{ .ID }}</td>
            <td>{{ .Class }}</td>
            <td>{{ .Number }}</td>
            <td>{{ .Name }}</td>
            <td>{{ .Role }}</td>
            <td>
                <button><a href="/reset?account_id={{ .ID }}">重設密碼</a></button>
            </td>
            {{ if eq $acct.Role 1 }}
            <td>
                {{ if eq .Role 2 }}
                <button value="{{ .ID }}" onclick="update(this, 1, '')">設為管理員</button>
                {{ else if and (eq .Role 1) (ne .ID "admin") }}
                <button value="{{ .ID }}" onclick="update(this, 2, '')">設為老師</button>
                {{ end }}
            </td>
            <td>
                {{ if ne .ID "admin" }}
                <button value="{{ .ID }}" onclick="deleteAccount(this)">刪除帳號</button>
                {{ end }}
            </td>
            {{ end }} 
        </tr>
        {{ end }}
    </tbody>
</table>
{{ end }}